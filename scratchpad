SELECT *,
  CASE
    WHEN DATEDIFF(day, "today", T1.'Due') <= 0 THEN 'YES'
    ELSE 'NO'
  END AS 'OVERDUE?',

  CASE
    WHEN T1.'ResolvedDate' IS NOT NULL AND T1.'ResolvedDate' != '' THEN T1.'ResolvedDate'
    WHEN T1.'EstimatedDateToRemediate' IS NOT NULL AND T1.'EstimatedDateToRemediate' != '' THEN T1.'EstimatedDateToRemediate'
    ELSE FORMATDATE(DATEADD(year, 1, DATE_TRUNC('year', CURRENT_DATE)))
  END AS 'ReportedRemediationDate'

FROM T1
