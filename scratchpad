SELECT *,
  CASE
    WHEN DATEDIFF(day, "today", T1.'Due') <= 0 THEN 'YES'
    ELSE 'NO'
  END AS 'OVERDUE?',

  CASE
    WHEN T1.'ResolvedDate' IS NOT NULL AND T1.'ResolvedDate' != '' THEN T1.'ResolvedDate'
    WHEN T1.'EstimatedDateToRemediate' IS NOT NULL AND T1.'EstimatedDateToRemediate' != '' THEN T1.'EstimatedDateToRemediate'
    ELSE CONCAT(CAST(YEAR(CURRENT_DATE) + 1 AS STRING), '-01-01')
  END AS 'ReportedRemediationDate'

FROM T1
