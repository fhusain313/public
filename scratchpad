let
    // Step 1: Load source table (change name below to your actual table name)
    Source = Excel.CurrentWorkbook(){[Name="YourTableName"]}[Content],

    // Step 2: Group by Namespace and CleanedPackage, combine versions
    Grouped = Table.Group(Source, {"Namespace", "CleanedPackage"}, {
        {"CombinedVersions", each Text.Combine(List.Transform([Version], Text.From), ", "), type text}
    }),

    // Step 3: Pivot with a safe aggregation function (Text.Combine again to flatten)
    Pivoted = Table.Pivot(
        Grouped,
        List.Distinct(Grouped[CleanedPackage]),
        "CleanedPackage",
        each Text.Combine({_[CombinedVersions]}, ", ")
    ),

    // Step 4: Replace nulls with blank strings
    Cleaned = Table.ReplaceValue(Pivoted, null, "", Replacer.ReplaceValue, Table.ColumnNames(Pivoted))
in
    Cleaned
